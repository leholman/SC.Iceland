plot(ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0(),pch=16,xlab="Cal Yr BP",ylab="replicates +ive",xlim=c(220,3600))
plot(ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0(),pch=16,xlab="Cal Yr BP",ylab="replicates +ive",xlim=c(3600,220))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0(),pch=16,xlab="Cal Yr BP",ylab="replicates +ive")
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
par(mfrow=c(2,1),mar=c(2.5, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0(),pch=16,xlab="Year (CE)",ylab="replicates +ive")
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0(),pch=16,xlab="Year (CE)",ylab="replicates +ive")
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0(),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0(),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
par(mfrow=c(2,1),mar=c(3, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0(),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0(),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0(),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0(),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
par(mfrow=c(2,1),mar=c(4.1, 4.1, 3.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0(),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0(),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("test"),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 ",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
paste0("figures/SpecificTaxa/fish/EUK.",taxa,".pdf")
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/fish/EUK.",taxa,".pdf"),height=6,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Genus"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/fish/EUK.",taxa,".pdf"),height=6,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Genus"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/fish/EUK.",taxa,".pdf"),height=6,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Family"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/fish/EUK.",taxa,".pdf"),height=6,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Order"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/fish/EUK.",taxa,".pdf"),height=6,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Genus"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/fish/EUK.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Family"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/fish/EUK.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Order"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/fish/EUK.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Genus"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/fish/EUK.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Family"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/fish/EUK.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Order"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/fish/EUK.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Order:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Order:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
### lets make some fish plots
EUKtax.h <- read.csv("taxonomy/byHand/EUKtax_assigned1006.csv")
unique(EUKtax.h$Assignment[EUKtax.h$Level=="Family"])
### lets make some fish plots
EUKtax.h <- read.csv("taxonomy/byHand/EUKtax_assigned1006.csv")
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Genus"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/fish/EUK.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Family"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/fish/EUK.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Order"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/fish/EUK.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Order:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Order:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
### now some whale plots
RIZtax.h <- read.csv("taxonomy/byHand/RIZtax_assigned2105.csv")
unique(RIZtax.h$Assignment[RIZtax.h$Level=="Genus"])
RIZtax.h$Level
unique(RIZtax.h$Level)
RIZtax.h$ID
unique(RIZtax.h$ID[RIZtax.h$Level=="Genus"])
unique(RIZtax.h$ID[RIZtax.h$Level=="Species"])
unique(RIZtax.h$ID[RIZtax.h$Level=="Family"])
unique(RIZtax.h$ID[RIZtax.h$Level=="Order"])
unique(RIZtax.h$ID[RIZtax.h$Level=="Species" & RIZtax.h$X.1.base.in.difference=="Y"])
taxa <- "Balaena mysticetus"
loopASVs <- RIZtax.h$OTU[RIZtax.h$Assignment==taxa]
loopASVs <- RIZtax.h$ID[RIZtax.h$Assignment==taxa]
unique(RIZtax.h$ID[RIZtax.h$Level=="Family"])
loopASVs <- RIZtax.h$OTU[RIZtax.h$ID==taxa]
loopData1 <- RIZ.P19.nREPS[loopASVs,]
loopData2 <- RIZ.GC1.nREPS[loopASVs,]
View(loopData1)
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
MAM.GC1 <- read.csv("cleaneddata/combinedcoredata/MAM.GC01.csv",row.names = 1)
MAM.GC1.nREPS <- NrepsMaker(MAM.GC1,gsub("(.*)_[0-9]$","\\1",colnames(MAM.GC1)))
### RIZ datasets
RIZ.P19 <- read.csv("cleaneddata/combinedcoredata/RIZ.PC019.csv",row.names = 1)
RIZ.P19.nREPS <- NrepsMaker(RIZ.P19,gsub("(.*)_[0-9]$","\\1",colnames(RIZ.P19)))
RIZ.GC1 <- read.csv("cleaneddata/combinedcoredata/RIZ.GC01.csv",row.names = 1)
RIZ.GC1.nREPS <- NrepsMaker(RIZ.GC1,gsub("(.*)_[0-9]$","\\1",colnames(RIZ.GC1)))
loopASVs <- RIZtax.h$OTU[RIZtax.h$ID==taxa]
loopData1 <- RIZ.P19.nREPS[loopASVs,]
loopData2 <- RIZ.GC1.nREPS[loopASVs,]
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
for (taxa in unique(RIZtax.h$ID[RIZtax.h$Level=="Genus"])){
loopASVs <- RIZtax.h$OTU[RIZtax.h$ID==taxa]
loopData1 <- RIZ.P19.nREPS[loopASVs,]
loopData2 <- RIZ.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/RIZ.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(RIZtax.h$ID[RIZtax.h$Level=="Species" & RIZtax.h$X.1.base.in.difference=="Y"])){
loopASVs <- RIZtax.h$OTU[RIZtax.h$ID==taxa]
loopData1 <- RIZ.P19.nREPS[loopASVs,]
loopData2 <- RIZ.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/RIZ.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Species:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Species:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(RIZtax.h$ID[RIZtax.h$Level=="Genus"])){
loopASVs <- RIZtax.h$OTU[RIZtax.h$ID==taxa]
loopData1 <- RIZ.P19.nREPS[loopASVs,]
loopData2 <- RIZ.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/RIZ.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(RIZtax.h$Assignment[RIZtax.h$Level=="Family"])){
loopASVs <- RIZtax.h$OTU[RIZtax.h$ID==taxa]
loopData1 <- RIZ.P19.nREPS[loopASVs,]
loopData2 <- RIZ.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/RIZ.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
MAMtax.h <- read.csv("taxonomy/byHand/MAMtax_assigned2105.csv")
unique(MAMtax.h$ID[MAMtax.h$Level=="Family"])
unique(MAMtax.h$ID[MAMtax.h$Level=="Genus"])
unique(MAMtax.h$ID[MAMtax.h$Level=="Species" & MAMtax.h$X.1.base.in.difference=="Y"])
MAMtax.h <- read.csv("taxonomy/byHand/MAMtax_assigned2105.csv")
MAMtax.h <- read.csv("taxonomy/byHand/MAMtax_assigned2105.csv")
unique(MAMtax.h$[MAMtax.h$Level=="Family"])
unique(MAMtax.h$ID[MAMtax.h$Level=="Family"])
unique(MAMtax.h$ID[MAMtax.h$Level=="Genus"])
unique(MAMtax.h$ID[MAMtax.h$Level=="Species" & MAMtax.h$X.1.base.in.difference=="Y"])
for (taxa in unique(MAMtax.h$ID[MAMtax.h$Level=="Species" & MAMtax.h$X.1.base.in.difference=="Y"])){
loopASVs <- MAMtax.h$OTU[MAMtax.h$ID==taxa]
loopData1 <- MAM.P19.nREPS[loopASVs,]
loopData2 <- MAM.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/MAM.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Species:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Species:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(MAMtax.h$ID[MAMtax.h$Level=="Genus"])){
loopASVs <- MAMtax.h$OTU[MAMtax.h$ID==taxa]
loopData1 <- MAM.P19.nREPS[loopASVs,]
loopData2 <- MAM.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/MAM.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(MAMtax.h$Assignment[MAMtax.h$Level=="Family"])){
loopASVs <- MAMtax.h$OTU[MAMtax.h$ID==taxa]
loopData1 <- MAM.P19.nREPS[loopASVs,]
loopData2 <- MAM.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/MAM.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
MAMtax.h <- read.csv("taxonomy/byHand/MAMtax_assigned2105.csv")
unique(MAMtax.h$ID[MAMtax.h$Level=="Family"])
for (taxa in unique(MAMtax.h$Assignment[MAMtax.h$Level=="Family"])){
loopASVs <- MAMtax.h$OTU[MAMtax.h$ID==taxa]
loopData1 <- MAM.P19.nREPS[loopASVs,]
loopData2 <- MAM.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/MAM.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
unique(MAMtax.h$Assignment[MAMtax.h$Level=="Family"])
for (taxa in unique(MAMtax.h$ID[MAMtax.h$Level=="Family"])){
loopASVs <- MAMtax.h$OTU[MAMtax.h$ID==taxa]
loopData1 <- MAM.P19.nREPS[loopASVs,]
loopData2 <- MAM.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/MAM.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
### lets make some fish plots
EUKtax.h <- read.csv("taxonomy/byHand/EUKtax_assigned1006.csv")
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Genus"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/EUK.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Family"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/EUK.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Order"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/EUK.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Order:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Order:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
### now some whale plots
##RIZ
RIZtax.h <- read.csv("taxonomy/byHand/RIZtax_assigned2105.csv")
unique(RIZtax.h$ID[RIZtax.h$Level=="Family"])
unique(RIZtax.h$ID[RIZtax.h$Level=="Genus"])
unique(RIZtax.h$ID[RIZtax.h$Level=="Species" & RIZtax.h$X.1.base.in.difference=="Y"])
for (taxa in unique(RIZtax.h$ID[RIZtax.h$Level=="Species" & RIZtax.h$X.1.base.in.difference=="Y"])){
loopASVs <- RIZtax.h$OTU[RIZtax.h$ID==taxa]
loopData1 <- RIZ.P19.nREPS[loopASVs,]
loopData2 <- RIZ.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/RIZ.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Species:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Species:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(RIZtax.h$ID[RIZtax.h$Level=="Genus"])){
loopASVs <- RIZtax.h$OTU[RIZtax.h$ID==taxa]
loopData1 <- RIZ.P19.nREPS[loopASVs,]
loopData2 <- RIZ.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/RIZ.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(RIZtax.h$Assignment[RIZtax.h$Level=="Family"])){
loopASVs <- RIZtax.h$OTU[RIZtax.h$ID==taxa]
loopData1 <- RIZ.P19.nREPS[loopASVs,]
loopData2 <- RIZ.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/RIZ.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
##MAM
MAMtax.h <- read.csv("taxonomy/byHand/MAMtax_assigned2105.csv")
unique(MAMtax.h$ID[MAMtax.h$Level=="Family"])
unique(MAMtax.h$ID[MAMtax.h$Level=="Genus"])
unique(MAMtax.h$ID[MAMtax.h$Level=="Species" & MAMtax.h$X.1.base.in.difference=="Y"])
for (taxa in unique(MAMtax.h$ID[MAMtax.h$Level=="Species" & MAMtax.h$X.1.base.in.difference=="Y"])){
loopASVs <- MAMtax.h$OTU[MAMtax.h$ID==taxa]
loopData1 <- MAM.P19.nREPS[loopASVs,]
loopData2 <- MAM.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/MAM.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Species:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Species:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(MAMtax.h$ID[MAMtax.h$Level=="Genus"])){
loopASVs <- MAMtax.h$OTU[MAMtax.h$ID==taxa]
loopData1 <- MAM.P19.nREPS[loopASVs,]
loopData2 <- MAM.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/MAM.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(MAMtax.h$ID[MAMtax.h$Level=="Family"])){
loopASVs <- MAMtax.h$OTU[MAMtax.h$ID==taxa]
loopData1 <- MAM.P19.nREPS[loopASVs,]
loopData2 <- MAM.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/MAM.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
### lets make some fish plots
EUKtax.h <- read.csv("taxonomy/byHand/EUKtax_assigned1006.csv")
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Genus"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/EUK.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Family"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/EUK.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(EUKtax.h$Assignment[EUKtax.h$Level=="Order"])){
loopASVs <- EUKtax.h$OTU[EUKtax.h$Assignment==taxa]
loopData1 <- EUK.P19.nREPS[loopASVs,]
loopData2 <- EUK.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/EUK.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Order:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Order:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
### now some whale plots
##RIZ
RIZtax.h <- read.csv("taxonomy/byHand/RIZtax_assigned2105.csv")
unique(RIZtax.h$ID[RIZtax.h$Level=="Family"])
unique(RIZtax.h$ID[RIZtax.h$Level=="Genus"])
unique(RIZtax.h$ID[RIZtax.h$Level=="Species" & RIZtax.h$X.1.base.in.difference=="Y"])
for (taxa in unique(RIZtax.h$ID[RIZtax.h$Level=="Species" & RIZtax.h$X.1.base.in.difference=="Y"])){
loopASVs <- RIZtax.h$OTU[RIZtax.h$ID==taxa]
loopData1 <- RIZ.P19.nREPS[loopASVs,]
loopData2 <- RIZ.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/RIZ.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Species:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Species:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(RIZtax.h$ID[RIZtax.h$Level=="Genus"])){
loopASVs <- RIZtax.h$OTU[RIZtax.h$ID==taxa]
loopData1 <- RIZ.P19.nREPS[loopASVs,]
loopData2 <- RIZ.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/RIZ.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(RIZtax.h$Assignment[RIZtax.h$Level=="Family"])){
loopASVs <- RIZtax.h$OTU[RIZtax.h$ID==taxa]
loopData1 <- RIZ.P19.nREPS[loopASVs,]
loopData2 <- RIZ.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/RIZ.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
##MAM
MAMtax.h <- read.csv("taxonomy/byHand/MAMtax_assigned2105.csv")
unique(MAMtax.h$ID[MAMtax.h$Level=="Family"])
unique(MAMtax.h$ID[MAMtax.h$Level=="Genus"])
unique(MAMtax.h$ID[MAMtax.h$Level=="Species" & MAMtax.h$X.1.base.in.difference=="Y"])
for (taxa in unique(MAMtax.h$ID[MAMtax.h$Level=="Species" & MAMtax.h$X.1.base.in.difference=="Y"])){
loopASVs <- MAMtax.h$OTU[MAMtax.h$ID==taxa]
loopData1 <- MAM.P19.nREPS[loopASVs,]
loopData2 <- MAM.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/MAM.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Species:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Species:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(MAMtax.h$ID[MAMtax.h$Level=="Genus"])){
loopASVs <- MAMtax.h$OTU[MAMtax.h$ID==taxa]
loopData1 <- MAM.P19.nREPS[loopASVs,]
loopData2 <- MAM.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/MAM.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Genus:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
for (taxa in unique(MAMtax.h$ID[MAMtax.h$Level=="Family"])){
loopASVs <- MAMtax.h$OTU[MAMtax.h$ID==taxa]
loopData1 <- MAM.P19.nREPS[loopASVs,]
loopData2 <- MAM.GC1.nREPS[loopASVs,]
pdf(paste0("figures/SpecificTaxa/MAM.",taxa,".pdf"),height=7,width = 9)
par(mfrow=c(2,1),mar=c(4.1, 4.1, 1.1, 1.1))
plot(1950-ages$median[match(colnames(loopData1),ages$ID2)],jitter(as.numeric(colSums(loopData1))),main=paste0("PC19 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
plot(1950-ages$median[match(colnames(loopData2),ages$ID2)],jitter(as.numeric(colSums(loopData2))),main=paste0("GC01 Family:",taxa),pch=16,xlab="Year (CE)",ylab="replicates +ive",xlim=c(-1550,1700))
dev.off()
}
