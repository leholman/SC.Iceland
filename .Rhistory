points(year2,value2,pch=16,col="lightblue4")
abline(h=4,lty=2,col="grey")
par(mar=c(4.1,4.1,2.1,6.1))
plot(year1,value1,pch=16,col="slateblue",ylim=c(0,8),
xlim=c(-1550,2000),bty = 'n',xaxt="n",yaxt='n',ylab="P.periphylla DetectionProp",xlab="",col.lab ="navyblue")
axis(2,at=c(0,2,4,6,8),label=c(0,0.25,0.5,0.75,1.0),las=1,cex.axis=0.8)
axis(3,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
points(year2,value2,pch=16,col="lightblue4")
pdf("figures/composite/p.periphyllaDNA.pdf",height=4,width=10)
par(mar=c(4.1,4.1,2.1,6.1))
plot(year1,value1,pch=16,col="slateblue",ylim=c(0,8),
xlim=c(-1550,2000),bty = 'n',xaxt="n",yaxt='n',ylab="P.periphylla DetectionProp",xlab="",col.lab ="navyblue")
axis(2,at=c(0,2,4,6,8),label=c(0,0.25,0.5,0.75,1.0),las=1,cex.axis=0.8)
axis(1,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
points(year2,value2,pch=16,col="lightblue4")
abline(h=4,lty=2,col="grey")
polygon(c(prediction$year, rev(prediction$year)), c(prediction$uppCI, rev(prediction$lwrCI)), col=add.alpha('mediumslateblue',0.3), border=NA)
points(prediction$year,prediction$fit,type="l",col="navyblue",lwd=3)
polygon(c(prediction2$year, rev(prediction2$year)), c(prediction2$uppCI, rev(prediction2$lwrCI)), col=add.alpha('lightblue4',0.3), border=NA)
points(prediction2$year,prediction2$fit,type="l",col="cadetblue4",lwd=3)
dev.off()
ASV <-776
plot(1950-ages$median[match(colnames(EUK.P19.nREPS[ASV,]),ages$ID2)],jitter(as.numeric(EUK.P19.nREPS[ASV,])),pch=16,xlab="Cal Yr BP",ylab="replicates +ive",xlim=c(-1550,2000))
plot(1950-ages$median[match(colnames(EUK.GC1.nREPS[ASV,]),ages$ID2)],jitter(as.numeric(EUK.GC1.nREPS[ASV,])),pch=16,xlab="Cal Yr BP",ylab="replicates +ive",xlim=c(-1550,2000))
plot(1950-ages$median[match(colnames(EUK.P19.nREPS[ASV,]),ages$ID2)],jitter(as.numeric(EUK.P19.nREPS[ASV,])),pch=16,xlab="Cal Yr BP",ylab="replicates +ive",xlim=c(-1550,2000))
plot(1950-ages$median[match(colnames(EUK.GC1.nREPS[ASV,]),ages$ID2)],jitter(as.numeric(EUK.GC1.nREPS[ASV,])),pch=16,xlab="Cal Yr BP",ylab="replicates +ive",xlim=c(-1550,2000))
plot(1950-ages$median[match(colnames(EUK.GC1.nREPS[ASV,]),ages$ID2)],jitter(as.numeric(EUK.GC1.nREPS[ASV,])),pch=16,xlab="Cal Yr BP",ylab="replicates +ive",xlim=c(-1550,2000))
plot(1950-ages$median[match(colnames(EUK.P19.nREPS[ASV,]),ages$ID2)],jitter(as.numeric(EUK.P19.nREPS[ASV,])),pch=16,xlab="Cal Yr BP",ylab="replicates +ive",xlim=c(-1550,2000))
plot(1950-ages$median[match(colnames(EUK.GC1.nREPS[ASV,]),ages$ID2)],jitter(as.numeric(EUK.GC1.nREPS[ASV,])),pch=16,xlab="Cal Yr BP",ylab="replicates +ive",xlim=c(-1550,2000))
ASV <-838
plot(1950-ages$median[match(colnames(EUK.P19.nREPS[ASV,]),ages$ID2)],jitter(as.numeric(EUK.P19.nREPS[ASV,])),pch=16,xlab="Cal Yr BP",ylab="replicates +ive",xlim=c(-1550,2000))
plot(1950-ages$median[match(colnames(EUK.GC1.nREPS[ASV,]),ages$ID2)],jitter(as.numeric(EUK.GC1.nREPS[ASV,])),pch=16,xlab="Cal Yr BP",ylab="replicates +ive",xlim=c(-1550,2000))
loopASVs <- 838
loopData1 <- colSums(EUK.P19[loopASVs,])
loopData1 <- tapply(loopData1 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData1)), sum)
loopData2 <- colSums(EUK.GC1[loopASVs,])
loopData2 <- tapply(loopData2 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData2)), sum)
year1 <- 1950-ages$mean[match(names(loopData1),ages$ID2)]
value1 <- as.numeric(loopData1)
year2 <- 1950-ages$mean[match(names(loopData2),ages$ID2)]
value2 <- as.numeric(loopData2)
gam1 <- gam(value1 ~ s(year1,k=20), method = "REML")
gam2 <- gam(value2 ~ s(year2,k=20), method = "REML")
plot(gam1)
plot(gam2)
prediction <- data.frame("year1"=-1103:1725)
prediction <- cbind(prediction,predict(gam1,newdata = prediction,se.fit = TRUE))
prediction$uppCI <- prediction$fit+prediction$se.fit*1.96
prediction$lwrCI <- prediction$fit-prediction$se.fit*1.96
prediction2 <- data.frame("year2"=-1561:1668)
prediction2 <- cbind(prediction2,predict(gam2,newdata = prediction2,se.fit = TRUE))
prediction2$uppCI <- prediction2$fit+prediction2$se.fit*1.96
prediction2$lwrCI <- prediction2$fit-prediction2$se.fit*1.96
par(mar=c(4.1,4.1,2.1,6.1))
plot(year1,value1,pch=16,col="slateblue",ylim=c(0,8),
xlim=c(-1550,2000),bty = 'n',xaxt="n",yaxt='n',ylab="P.periphylla DetectionProp",xlab="",col.lab ="navyblue")
axis(2,at=c(0,2,4,6,8),label=c(0,0.25,0.5,0.75,1.0),las=1,cex.axis=0.8)
axis(1,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
points(year2,value2,pch=16,col="lightblue4")
abline(h=4,lty=2,col="grey")
polygon(c(prediction$year, rev(prediction$year)), c(prediction$uppCI, rev(prediction$lwrCI)), col=add.alpha('mediumslateblue',0.3), border=NA)
points(prediction$year,prediction$fit,type="l",col="navyblue",lwd=3)
polygon(c(prediction2$year, rev(prediction2$year)), c(prediction2$uppCI, rev(prediction2$lwrCI)), col=add.alpha('lightblue4',0.3), border=NA)
points(prediction2$year,prediction2$fit,type="l",col="cadetblue4",lwd=3)
loopASVs <- 850
loopData1 <- colSums(EUK.P19[loopASVs,])
loopData1 <- tapply(loopData1 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData1)), sum)
loopData2 <- colSums(EUK.GC1[loopASVs,])
loopData2 <- tapply(loopData2 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData2)), sum)
year1 <- 1950-ages$mean[match(names(loopData1),ages$ID2)]
value1 <- as.numeric(loopData1)
year2 <- 1950-ages$mean[match(names(loopData2),ages$ID2)]
value2 <- as.numeric(loopData2)
gam1 <- gam(value1 ~ s(year1,k=20), method = "REML")
gam2 <- gam(value2 ~ s(year2,k=20), method = "REML")
plot(gam1)
plot(gam2)
prediction <- data.frame("year1"=-1103:1725)
prediction <- cbind(prediction,predict(gam1,newdata = prediction,se.fit = TRUE))
prediction$uppCI <- prediction$fit+prediction$se.fit*1.96
prediction$lwrCI <- prediction$fit-prediction$se.fit*1.96
prediction2 <- data.frame("year2"=-1561:1668)
prediction2 <- cbind(prediction2,predict(gam2,newdata = prediction2,se.fit = TRUE))
prediction2$uppCI <- prediction2$fit+prediction2$se.fit*1.96
prediction2$lwrCI <- prediction2$fit-prediction2$se.fit*1.96
par(mar=c(4.1,4.1,2.1,6.1))
plot(year1,value1,pch=16,col="slateblue",ylim=c(0,8),
xlim=c(-1550,2000),bty = 'n',xaxt="n",yaxt='n',ylab="P.periphylla DetectionProp",xlab="",col.lab ="navyblue")
axis(2,at=c(0,2,4,6,8),label=c(0,0.25,0.5,0.75,1.0),las=1,cex.axis=0.8)
axis(1,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
points(year2,value2,pch=16,col="lightblue4")
abline(h=4,lty=2,col="grey")
polygon(c(prediction$year, rev(prediction$year)), c(prediction$uppCI, rev(prediction$lwrCI)), col=add.alpha('mediumslateblue',0.3), border=NA)
points(prediction$year,prediction$fit,type="l",col="navyblue",lwd=3)
polygon(c(prediction2$year, rev(prediction2$year)), c(prediction2$uppCI, rev(prediction2$lwrCI)), col=add.alpha('lightblue4',0.3), border=NA)
points(prediction2$year,prediction2$fit,type="l",col="cadetblue4",lwd=3)
loopASVs <- 874
loopData1 <- colSums(EUK.P19[loopASVs,])
loopData1 <- tapply(loopData1 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData1)), sum)
loopData2 <- colSums(EUK.GC1[loopASVs,])
loopData2 <- tapply(loopData2 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData2)), sum)
year1 <- 1950-ages$mean[match(names(loopData1),ages$ID2)]
value1 <- as.numeric(loopData1)
year2 <- 1950-ages$mean[match(names(loopData2),ages$ID2)]
value2 <- as.numeric(loopData2)
gam1 <- gam(value1 ~ s(year1,k=20), method = "REML")
gam2 <- gam(value2 ~ s(year2,k=20), method = "REML")
plot(gam1)
plot(gam2)
prediction <- data.frame("year1"=-1103:1725)
prediction <- cbind(prediction,predict(gam1,newdata = prediction,se.fit = TRUE))
prediction$uppCI <- prediction$fit+prediction$se.fit*1.96
prediction$lwrCI <- prediction$fit-prediction$se.fit*1.96
prediction2 <- data.frame("year2"=-1561:1668)
prediction2 <- cbind(prediction2,predict(gam2,newdata = prediction2,se.fit = TRUE))
prediction2$uppCI <- prediction2$fit+prediction2$se.fit*1.96
prediction2$lwrCI <- prediction2$fit-prediction2$se.fit*1.96
par(mar=c(4.1,4.1,2.1,6.1))
plot(year1,value1,pch=16,col="slateblue",ylim=c(0,8),
xlim=c(-1550,2000),bty = 'n',xaxt="n",yaxt='n',ylab="P.periphylla DetectionProp",xlab="",col.lab ="navyblue")
axis(2,at=c(0,2,4,6,8),label=c(0,0.25,0.5,0.75,1.0),las=1,cex.axis=0.8)
axis(1,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
points(year2,value2,pch=16,col="lightblue4")
abline(h=4,lty=2,col="grey")
polygon(c(prediction$year, rev(prediction$year)), c(prediction$uppCI, rev(prediction$lwrCI)), col=add.alpha('mediumslateblue',0.3), border=NA)
points(prediction$year,prediction$fit,type="l",col="navyblue",lwd=3)
polygon(c(prediction2$year, rev(prediction2$year)), c(prediction2$uppCI, rev(prediction2$lwrCI)), col=add.alpha('lightblue4',0.3), border=NA)
points(prediction2$year,prediction2$fit,type="l",col="cadetblue4",lwd=3)
loopASVs <- 850
loopData1 <- colSums(EUK.P19[loopASVs,])
loopData1 <- tapply(loopData1 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData1)), sum)
loopData2 <- colSums(EUK.GC1[loopASVs,])
loopData2 <- tapply(loopData2 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData2)), sum)
year1 <- 1950-ages$mean[match(names(loopData1),ages$ID2)]
value1 <- as.numeric(loopData1)
year2 <- 1950-ages$mean[match(names(loopData2),ages$ID2)]
value2 <- as.numeric(loopData2)
gam1 <- gam(value1 ~ s(year1,k=20), method = "REML")
gam2 <- gam(value2 ~ s(year2,k=20), method = "REML")
plot(gam1)
plot(gam2)
prediction <- data.frame("year1"=-1103:1725)
prediction <- cbind(prediction,predict(gam1,newdata = prediction,se.fit = TRUE))
prediction$uppCI <- prediction$fit+prediction$se.fit*1.96
prediction$lwrCI <- prediction$fit-prediction$se.fit*1.96
prediction2 <- data.frame("year2"=-1561:1668)
prediction2 <- cbind(prediction2,predict(gam2,newdata = prediction2,se.fit = TRUE))
prediction2$uppCI <- prediction2$fit+prediction2$se.fit*1.96
prediction2$lwrCI <- prediction2$fit-prediction2$se.fit*1.96
par(mar=c(4.1,4.1,2.1,6.1))
plot(year1,value1,pch=16,col="slateblue",ylim=c(0,8),
xlim=c(-1550,2000),bty = 'n',xaxt="n",yaxt='n',ylab="P.periphylla DetectionProp",xlab="",col.lab ="navyblue")
axis(2,at=c(0,2,4,6,8),label=c(0,0.25,0.5,0.75,1.0),las=1,cex.axis=0.8)
axis(1,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
points(year2,value2,pch=16,col="lightblue4")
abline(h=4,lty=2,col="grey")
polygon(c(prediction$year, rev(prediction$year)), c(prediction$uppCI, rev(prediction$lwrCI)), col=add.alpha('mediumslateblue',0.3), border=NA)
points(prediction$year,prediction$fit,type="l",col="navyblue",lwd=3)
polygon(c(prediction2$year, rev(prediction2$year)), c(prediction2$uppCI, rev(prediction2$lwrCI)), col=add.alpha('lightblue4',0.3), border=NA)
points(prediction2$year,prediction2$fit,type="l",col="cadetblue4",lwd=3)
loopASVs <- 948
loopData1 <- colSums(EUK.P19[loopASVs,])
loopData1 <- tapply(loopData1 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData1)), sum)
loopData2 <- colSums(EUK.GC1[loopASVs,])
loopData2 <- tapply(loopData2 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData2)), sum)
year1 <- 1950-ages$mean[match(names(loopData1),ages$ID2)]
value1 <- as.numeric(loopData1)
year2 <- 1950-ages$mean[match(names(loopData2),ages$ID2)]
value2 <- as.numeric(loopData2)
gam1 <- gam(value1 ~ s(year1,k=20), method = "REML")
gam2 <- gam(value2 ~ s(year2,k=20), method = "REML")
plot(gam1)
plot(gam2)
plot(gam1)
plot(gam2)
prediction <- data.frame("year1"=-1103:1725)
prediction <- cbind(prediction,predict(gam1,newdata = prediction,se.fit = TRUE))
prediction$uppCI <- prediction$fit+prediction$se.fit*1.96
prediction$lwrCI <- prediction$fit-prediction$se.fit*1.96
prediction2 <- data.frame("year2"=-1561:1668)
prediction2 <- cbind(prediction2,predict(gam2,newdata = prediction2,se.fit = TRUE))
prediction2$uppCI <- prediction2$fit+prediction2$se.fit*1.96
prediction2$lwrCI <- prediction2$fit-prediction2$se.fit*1.96
par(mar=c(4.1,4.1,2.1,6.1))
plot(year1,value1,pch=16,col="slateblue",ylim=c(0,8),
xlim=c(-1550,2000),bty = 'n',xaxt="n",yaxt='n',ylab="P.periphylla DetectionProp",xlab="",col.lab ="navyblue")
axis(2,at=c(0,2,4,6,8),label=c(0,0.25,0.5,0.75,1.0),las=1,cex.axis=0.8)
axis(1,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
points(year2,value2,pch=16,col="lightblue4")
abline(h=4,lty=2,col="grey")
polygon(c(prediction$year, rev(prediction$year)), c(prediction$uppCI, rev(prediction$lwrCI)), col=add.alpha('mediumslateblue',0.3), border=NA)
points(prediction$year,prediction$fit,type="l",col="navyblue",lwd=3)
polygon(c(prediction2$year, rev(prediction2$year)), c(prediction2$uppCI, rev(prediction2$lwrCI)), col=add.alpha('lightblue4',0.3), border=NA)
points(prediction2$year,prediction2$fit,type="l",col="cadetblue4",lwd=3)
loopASVs <- 987
loopData1 <- colSums(EUK.P19[loopASVs,])
loopData1 <- tapply(loopData1 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData1)), sum)
loopData2 <- colSums(EUK.GC1[loopASVs,])
loopData2 <- tapply(loopData2 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData2)), sum)
year1 <- 1950-ages$mean[match(names(loopData1),ages$ID2)]
value1 <- as.numeric(loopData1)
year2 <- 1950-ages$mean[match(names(loopData2),ages$ID2)]
value2 <- as.numeric(loopData2)
gam1 <- gam(value1 ~ s(year1,k=20), method = "REML")
gam2 <- gam(value2 ~ s(year2,k=20), method = "REML")
plot(gam1)
plot(gam2)
prediction <- cbind(prediction,predict(gam1,newdata = prediction,se.fit = TRUE))
prediction <- data.frame("year1"=-1103:1725)
prediction <- cbind(prediction,predict(gam1,newdata = prediction,se.fit = TRUE))
prediction$uppCI <- prediction$fit+prediction$se.fit*1.96
prediction$lwrCI <- prediction$fit-prediction$se.fit*1.96
prediction2 <- data.frame("year2"=-1561:1668)
prediction2 <- cbind(prediction2,predict(gam2,newdata = prediction2,se.fit = TRUE))
prediction2$uppCI <- prediction2$fit+prediction2$se.fit*1.96
prediction2$lwrCI <- prediction2$fit-prediction2$se.fit*1.96
par(mar=c(4.1,4.1,2.1,6.1))
plot(year1,value1,pch=16,col="slateblue",ylim=c(0,8),
xlim=c(-1550,2000),bty = 'n',xaxt="n",yaxt='n',ylab="P.periphylla DetectionProp",xlab="",col.lab ="navyblue")
par(mar=c(4.1,4.1,2.1,6.1))
plot(year1,value1,pch=16,col="slateblue",ylim=c(0,8),
xlim=c(-1550,2000),bty = 'n',xaxt="n",yaxt='n',ylab="P.periphylla DetectionProp",xlab="",col.lab ="navyblue")
axis(2,at=c(0,2,4,6,8),label=c(0,0.25,0.5,0.75,1.0),las=1,cex.axis=0.8)
axis(1,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
points(year2,value2,pch=16,col="lightblue4")
abline(h=4,lty=2,col="grey")
polygon(c(prediction$year, rev(prediction$year)), c(prediction$uppCI, rev(prediction$lwrCI)), col=add.alpha('mediumslateblue',0.3), border=NA)
points(prediction$year,prediction$fit,type="l",col="navyblue",lwd=3)
polygon(c(prediction2$year, rev(prediction2$year)), c(prediction2$uppCI, rev(prediction2$lwrCI)), col=add.alpha('lightblue4',0.3), border=NA)
points(prediction2$year,prediction2$fit,type="l",col="cadetblue4",lwd=3)
loopASVs <- 1000
loopData1 <- colSums(EUK.P19[loopASVs,])
loopData1 <- tapply(loopData1 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData1)), sum)
loopData2 <- colSums(EUK.GC1[loopASVs,])
loopData2 <- tapply(loopData2 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData2)), sum)
year1 <- 1950-ages$mean[match(names(loopData1),ages$ID2)]
value1 <- as.numeric(loopData1)
year2 <- 1950-ages$mean[match(names(loopData2),ages$ID2)]
value2 <- as.numeric(loopData2)
gam1 <- gam(value1 ~ s(year1,k=20), method = "REML")
gam2 <- gam(value2 ~ s(year2,k=20), method = "REML")
plot(gam1)
plot(gam2)
prediction <- data.frame("year1"=-1103:1725)
prediction <- cbind(prediction,predict(gam1,newdata = prediction,se.fit = TRUE))
prediction$uppCI <- prediction$fit+prediction$se.fit*1.96
prediction$lwrCI <- prediction$fit-prediction$se.fit*1.96
prediction2 <- data.frame("year2"=-1561:1668)
prediction2 <- cbind(prediction2,predict(gam2,newdata = prediction2,se.fit = TRUE))
prediction2$uppCI <- prediction2$fit+prediction2$se.fit*1.96
prediction2$lwrCI <- prediction2$fit-prediction2$se.fit*1.96
par(mar=c(4.1,4.1,2.1,6.1))
plot(year1,value1,pch=16,col="slateblue",ylim=c(0,8),
xlim=c(-1550,2000),bty = 'n',xaxt="n",yaxt='n',ylab="P.periphylla DetectionProp",xlab="",col.lab ="navyblue")
axis(2,at=c(0,2,4,6,8),label=c(0,0.25,0.5,0.75,1.0),las=1,cex.axis=0.8)
axis(1,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
points(year2,value2,pch=16,col="lightblue4")
abline(h=4,lty=2,col="grey")
polygon(c(prediction$year, rev(prediction$year)), c(prediction$uppCI, rev(prediction$lwrCI)), col=add.alpha('mediumslateblue',0.3), border=NA)
points(prediction$year,prediction$fit,type="l",col="navyblue",lwd=3)
polygon(c(prediction2$year, rev(prediction2$year)), c(prediction2$uppCI, rev(prediction2$lwrCI)), col=add.alpha('lightblue4',0.3), border=NA)
points(prediction2$year,prediction2$fit,type="l",col="cadetblue4",lwd=3)
loopASVs <- 1068
loopData1 <- colSums(EUK.P19[loopASVs,])
loopData1 <- tapply(loopData1 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData1)), sum)
loopData2 <- colSums(EUK.GC1[loopASVs,])
loopData2 <- tapply(loopData2 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData2)), sum)
year1 <- 1950-ages$mean[match(names(loopData1),ages$ID2)]
value1 <- as.numeric(loopData1)
year2 <- 1950-ages$mean[match(names(loopData2),ages$ID2)]
value2 <- as.numeric(loopData2)
gam1 <- gam(value1 ~ s(year1,k=20), method = "REML")
gam2 <- gam(value2 ~ s(year2,k=20), method = "REML")
plot(gam1)
plot(gam2)
prediction <- data.frame("year1"=-1103:1725)
prediction <- cbind(prediction,predict(gam1,newdata = prediction,se.fit = TRUE))
prediction$uppCI <- prediction$fit+prediction$se.fit*1.96
prediction$lwrCI <- prediction$fit-prediction$se.fit*1.96
prediction2 <- data.frame("year2"=-1561:1668)
prediction2 <- cbind(prediction2,predict(gam2,newdata = prediction2,se.fit = TRUE))
prediction2$uppCI <- prediction2$fit+prediction2$se.fit*1.96
prediction2$lwrCI <- prediction2$fit-prediction2$se.fit*1.96
par(mar=c(4.1,4.1,2.1,6.1))
plot(year1,value1,pch=16,col="slateblue",ylim=c(0,8),
xlim=c(-1550,2000),bty = 'n',xaxt="n",yaxt='n',ylab="P.periphylla DetectionProp",xlab="",col.lab ="navyblue")
axis(2,at=c(0,2,4,6,8),label=c(0,0.25,0.5,0.75,1.0),las=1,cex.axis=0.8)
axis(1,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
points(year2,value2,pch=16,col="lightblue4")
abline(h=4,lty=2,col="grey")
polygon(c(prediction$year, rev(prediction$year)), c(prediction$uppCI, rev(prediction$lwrCI)), col=add.alpha('mediumslateblue',0.3), border=NA)
points(prediction$year,prediction$fit,type="l",col="navyblue",lwd=3)
polygon(c(prediction2$year, rev(prediction2$year)), c(prediction2$uppCI, rev(prediction2$lwrCI)), col=add.alpha('lightblue4',0.3), border=NA)
loopASVs <- 1149
loopData1 <- colSums(EUK.P19[loopASVs,])
loopData1 <- tapply(loopData1 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData1)), sum)
loopData2 <- colSums(EUK.GC1[loopASVs,])
loopData2 <- tapply(loopData2 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData2)), sum)
year1 <- 1950-ages$mean[match(names(loopData1),ages$ID2)]
value1 <- as.numeric(loopData1)
year2 <- 1950-ages$mean[match(names(loopData2),ages$ID2)]
value2 <- as.numeric(loopData2)
gam1 <- gam(value1 ~ s(year1,k=20), method = "REML")
gam2 <- gam(value2 ~ s(year2,k=20), method = "REML")
plot(gam1)
plot(gam2)
prediction <- data.frame("year1"=-1103:1725)
prediction <- cbind(prediction,predict(gam1,newdata = prediction,se.fit = TRUE))
prediction$uppCI <- prediction$fit+prediction$se.fit*1.96
prediction$lwrCI <- prediction$fit-prediction$se.fit*1.96
prediction2 <- data.frame("year2"=-1561:1668)
prediction2 <- cbind(prediction2,predict(gam2,newdata = prediction2,se.fit = TRUE))
prediction2$uppCI <- prediction2$fit+prediction2$se.fit*1.96
prediction2$lwrCI <- prediction2$fit-prediction2$se.fit*1.96
par(mar=c(4.1,4.1,2.1,6.1))
plot(year1,value1,pch=16,col="slateblue",ylim=c(0,8),
xlim=c(-1550,2000),bty = 'n',xaxt="n",yaxt='n',ylab="P.periphylla DetectionProp",xlab="",col.lab ="navyblue")
axis(2,at=c(0,2,4,6,8),label=c(0,0.25,0.5,0.75,1.0),las=1,cex.axis=0.8)
axis(1,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
par(mar=c(4.1,4.1,2.1,6.1))
plot(year1,value1,pch=16,col="slateblue",ylim=c(0,8),
xlim=c(-1550,2000),bty = 'n',xaxt="n",yaxt='n',ylab="P.periphylla DetectionProp",xlab="",col.lab ="navyblue")
axis(2,at=c(0,2,4,6,8),label=c(0,0.25,0.5,0.75,1.0),las=1,cex.axis=0.8)
axis(1,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
points(year2,value2,pch=16,col="lightblue4")
abline(h=4,lty=2,col="grey")
polygon(c(prediction$year, rev(prediction$year)), c(prediction$uppCI, rev(prediction$lwrCI)), col=add.alpha('mediumslateblue',0.3), border=NA)
points(prediction$year,prediction$fit,type="l",col="navyblue",lwd=3)
polygon(c(prediction2$year, rev(prediction2$year)), c(prediction2$uppCI, rev(prediction2$lwrCI)), col=add.alpha('lightblue4',0.3), border=NA)
points(prediction2$year,prediction2$fit,type="l",col="cadetblue4",lwd=3)
for (ASVin in 900:1200){
loopASVs <- ASVin
loopData1 <- colSums(EUK.P19[loopASVs,])
loopData1 <- tapply(loopData1 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData1)), sum)
loopData2 <- colSums(EUK.GC1[loopASVs,])
loopData2 <- tapply(loopData2 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData2)), sum)
year1 <- 1950-ages$mean[match(names(loopData1),ages$ID2)]
value1 <- as.numeric(loopData1)
year2 <- 1950-ages$mean[match(names(loopData2),ages$ID2)]
value2 <- as.numeric(loopData2)
gam1 <- gam(value1 ~ s(year1,k=20), method = "REML")
gam2 <- gam(value2 ~ s(year2,k=20), method = "REML")
plot(gam1)
plot(gam2)
prediction <- data.frame("year1"=-1103:1725)
prediction <- cbind(prediction,predict(gam1,newdata = prediction,se.fit = TRUE))
prediction$uppCI <- prediction$fit+prediction$se.fit*1.96
prediction$lwrCI <- prediction$fit-prediction$se.fit*1.96
prediction2 <- data.frame("year2"=-1561:1668)
prediction2 <- cbind(prediction2,predict(gam2,newdata = prediction2,se.fit = TRUE))
prediction2$uppCI <- prediction2$fit+prediction2$se.fit*1.96
prediction2$lwrCI <- prediction2$fit-prediction2$se.fit*1.96
pdf(paste0("figures/composite/SillyPlots/",ASVin,".pdf"),height=4,width=10)
#pdf("figures/composite/p.periphyllaDNA.pdf",height=4,width=10)
par(mar=c(4.1,4.1,2.1,6.1))
plot(year1,value1,pch=16,col="slateblue",ylim=c(0,8),
xlim=c(-1550,2000),bty = 'n',xaxt="n",yaxt='n',ylab="P.periphylla DetectionProp",xlab="",col.lab ="navyblue")
axis(2,at=c(0,2,4,6,8),label=c(0,0.25,0.5,0.75,1.0),las=1,cex.axis=0.8)
axis(1,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
points(year2,value2,pch=16,col="lightblue4")
abline(h=4,lty=2,col="grey")
polygon(c(prediction$year, rev(prediction$year)), c(prediction$uppCI, rev(prediction$lwrCI)), col=add.alpha('mediumslateblue',0.3), border=NA)
points(prediction$year,prediction$fit,type="l",col="navyblue",lwd=3)
polygon(c(prediction2$year, rev(prediction2$year)), c(prediction2$uppCI, rev(prediction2$lwrCI)), col=add.alpha('lightblue4',0.3), border=NA)
points(prediction2$year,prediction2$fit,type="l",col="cadetblue4",lwd=3)
dev.off()
}
ASVin <- 900
loopASVs <- ASVin
loopData1 <- colSums(EUK.P19[loopASVs,])
loopData1 <- tapply(loopData1 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData1)), sum)
loopData2 <- colSums(EUK.GC1[loopASVs,])
loopData2 <- tapply(loopData2 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData2)), sum)
year1 <- 1950-ages$mean[match(names(loopData1),ages$ID2)]
value1 <- as.numeric(loopData1)
year2 <- 1950-ages$mean[match(names(loopData2),ages$ID2)]
value2 <- as.numeric(loopData2)
gam1 <- gam(value1 ~ s(year1,k=20), method = "REML")
gam2 <- gam(value2 ~ s(year2,k=20), method = "REML")
plot(gam1)
plot(gam2)
gam1 <- gam(value1 ~ s(year1,k=20), method = "REML")
year1 <- 1950-ages$mean[match(names(loopData1),ages$ID2)]
value1 <- as.numeric(loopData1)
calue1
value1
all(value1==0)
for (ASVin in 900:1200){
loopASVs <- ASVin
loopData1 <- colSums(EUK.P19[loopASVs,])
loopData1 <- tapply(loopData1 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData1)), sum)
loopData2 <- colSums(EUK.GC1[loopASVs,])
loopData2 <- tapply(loopData2 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData2)), sum)
year1 <- 1950-ages$mean[match(names(loopData1),ages$ID2)]
value1 <- as.numeric(loopData1)
year2 <- 1950-ages$mean[match(names(loopData2),ages$ID2)]
value2 <- as.numeric(loopData2)
if(all(value1==0)|all(value2==0))[next()]
for (ASVin in 900:1200){
loopASVs <- ASVin
loopData1 <- colSums(EUK.P19[loopASVs,])
loopData1 <- tapply(loopData1 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData1)), sum)
loopData2 <- colSums(EUK.GC1[loopASVs,])
loopData2 <- tapply(loopData2 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData2)), sum)
year1 <- 1950-ages$mean[match(names(loopData1),ages$ID2)]
value1 <- as.numeric(loopData1)
year2 <- 1950-ages$mean[match(names(loopData2),ages$ID2)]
value2 <- as.numeric(loopData2)
if(all(value1==0)|all(value2==0)){next()}
gam1 <- gam(value1 ~ s(year1,k=20), method = "REML")
gam2 <- gam(value2 ~ s(year2,k=20), method = "REML")
plot(gam1)
plot(gam2)
prediction <- data.frame("year1"=-1103:1725)
prediction <- cbind(prediction,predict(gam1,newdata = prediction,se.fit = TRUE))
prediction$uppCI <- prediction$fit+prediction$se.fit*1.96
prediction$lwrCI <- prediction$fit-prediction$se.fit*1.96
prediction2 <- data.frame("year2"=-1561:1668)
prediction2 <- cbind(prediction2,predict(gam2,newdata = prediction2,se.fit = TRUE))
prediction2$uppCI <- prediction2$fit+prediction2$se.fit*1.96
prediction2$lwrCI <- prediction2$fit-prediction2$se.fit*1.96
pdf(paste0("figures/composite/SillyPlots/",ASVin,".pdf"),height=4,width=10)
#pdf("figures/composite/p.periphyllaDNA.pdf",height=4,width=10)
par(mar=c(4.1,4.1,2.1,6.1))
plot(year1,value1,pch=16,col="slateblue",ylim=c(0,8),
xlim=c(-1550,2000),bty = 'n',xaxt="n",yaxt='n',ylab="P.periphylla DetectionProp",xlab="",col.lab ="navyblue")
axis(2,at=c(0,2,4,6,8),label=c(0,0.25,0.5,0.75,1.0),las=1,cex.axis=0.8)
axis(1,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
points(year2,value2,pch=16,col="lightblue4")
abline(h=4,lty=2,col="grey")
polygon(c(prediction$year, rev(prediction$year)), c(prediction$uppCI, rev(prediction$lwrCI)), col=add.alpha('mediumslateblue',0.3), border=NA)
points(prediction$year,prediction$fit,type="l",col="navyblue",lwd=3)
polygon(c(prediction2$year, rev(prediction2$year)), c(prediction2$uppCI, rev(prediction2$lwrCI)), col=add.alpha('lightblue4',0.3), border=NA)
points(prediction2$year,prediction2$fit,type="l",col="cadetblue4",lwd=3)
dev.off()
}
for (ASVin in 1200:1500){
loopASVs <- ASVin
loopData1 <- colSums(EUK.P19[loopASVs,])
loopData1 <- tapply(loopData1 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData1)), sum)
loopData2 <- colSums(EUK.GC1[loopASVs,])
loopData2 <- tapply(loopData2 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData2)), sum)
year1 <- 1950-ages$mean[match(names(loopData1),ages$ID2)]
value1 <- as.numeric(loopData1)
year2 <- 1950-ages$mean[match(names(loopData2),ages$ID2)]
value2 <- as.numeric(loopData2)
if(all(value1==0)|all(value2==0)){next()}
gam1 <- gam(value1 ~ s(year1,k=20), method = "REML")
gam2 <- gam(value2 ~ s(year2,k=20), method = "REML")
plot(gam1)
plot(gam2)
prediction <- data.frame("year1"=-1103:1725)
prediction <- cbind(prediction,predict(gam1,newdata = prediction,se.fit = TRUE))
prediction$uppCI <- prediction$fit+prediction$se.fit*1.96
prediction$lwrCI <- prediction$fit-prediction$se.fit*1.96
prediction2 <- data.frame("year2"=-1561:1668)
prediction2 <- cbind(prediction2,predict(gam2,newdata = prediction2,se.fit = TRUE))
prediction2$uppCI <- prediction2$fit+prediction2$se.fit*1.96
prediction2$lwrCI <- prediction2$fit-prediction2$se.fit*1.96
pdf(paste0("figures/composite/SillyPlots/",ASVin,".pdf"),height=4,width=10)
#pdf("figures/composite/p.periphyllaDNA.pdf",height=4,width=10)
par(mar=c(4.1,4.1,2.1,6.1))
plot(year1,value1,pch=16,col="slateblue",ylim=c(0,8),
xlim=c(-1550,2000),bty = 'n',xaxt="n",yaxt='n',ylab="P.periphylla DetectionProp",xlab="",col.lab ="navyblue")
axis(2,at=c(0,2,4,6,8),label=c(0,0.25,0.5,0.75,1.0),las=1,cex.axis=0.8)
axis(1,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
points(year2,value2,pch=16,col="lightblue4")
abline(h=4,lty=2,col="grey")
polygon(c(prediction$year, rev(prediction$year)), c(prediction$uppCI, rev(prediction$lwrCI)), col=add.alpha('mediumslateblue',0.3), border=NA)
points(prediction$year,prediction$fit,type="l",col="navyblue",lwd=3)
polygon(c(prediction2$year, rev(prediction2$year)), c(prediction2$uppCI, rev(prediction2$lwrCI)), col=add.alpha('lightblue4',0.3), border=NA)
points(prediction2$year,prediction2$fit,type="l",col="cadetblue4",lwd=3)
dev.off()
}
for (ASVin in 1500:1700){
loopASVs <- ASVin
loopData1 <- colSums(EUK.P19[loopASVs,])
loopData1 <- tapply(loopData1 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData1)), sum)
loopData2 <- colSums(EUK.GC1[loopASVs,])
loopData2 <- tapply(loopData2 > 0, gsub("(.*)_[0-9]$","\\1",names(loopData2)), sum)
year1 <- 1950-ages$mean[match(names(loopData1),ages$ID2)]
value1 <- as.numeric(loopData1)
year2 <- 1950-ages$mean[match(names(loopData2),ages$ID2)]
value2 <- as.numeric(loopData2)
if(all(value1==0)|all(value2==0)){next()}
gam1 <- gam(value1 ~ s(year1,k=20), method = "REML")
gam2 <- gam(value2 ~ s(year2,k=20), method = "REML")
plot(gam1)
plot(gam2)
prediction <- data.frame("year1"=-1103:1725)
prediction <- cbind(prediction,predict(gam1,newdata = prediction,se.fit = TRUE))
prediction$uppCI <- prediction$fit+prediction$se.fit*1.96
prediction$lwrCI <- prediction$fit-prediction$se.fit*1.96
prediction2 <- data.frame("year2"=-1561:1668)
prediction2 <- cbind(prediction2,predict(gam2,newdata = prediction2,se.fit = TRUE))
prediction2$uppCI <- prediction2$fit+prediction2$se.fit*1.96
prediction2$lwrCI <- prediction2$fit-prediction2$se.fit*1.96
pdf(paste0("figures/composite/SillyPlots/",ASVin,".pdf"),height=4,width=10)
#pdf("figures/composite/p.periphyllaDNA.pdf",height=4,width=10)
par(mar=c(4.1,4.1,2.1,6.1))
plot(year1,value1,pch=16,col="slateblue",ylim=c(0,8),
xlim=c(-1550,2000),bty = 'n',xaxt="n",yaxt='n',ylab="P.periphylla DetectionProp",xlab="",col.lab ="navyblue")
axis(2,at=c(0,2,4,6,8),label=c(0,0.25,0.5,0.75,1.0),las=1,cex.axis=0.8)
axis(1,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
points(year2,value2,pch=16,col="lightblue4")
abline(h=4,lty=2,col="grey")
polygon(c(prediction$year, rev(prediction$year)), c(prediction$uppCI, rev(prediction$lwrCI)), col=add.alpha('mediumslateblue',0.3), border=NA)
points(prediction$year,prediction$fit,type="l",col="navyblue",lwd=3)
polygon(c(prediction2$year, rev(prediction2$year)), c(prediction2$uppCI, rev(prediction2$lwrCI)), col=add.alpha('lightblue4',0.3), border=NA)
points(prediction2$year,prediction2$fit,type="l",col="cadetblue4",lwd=3)
dev.off()
}
