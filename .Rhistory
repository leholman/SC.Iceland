lane1 <- readxl::read_excel("DataSheet.xlsx",sheet = "Lane1")
View(lane1)
unique(lane1$SampleID)
sort(unique(lane1$SampleID))
grep(pattern = "GC",sort(unique(lane1$SampleID)))
sort(unique(lane1$SampleID))[grep(pattern = "GC",sort(unique(lane1$SampleID)))]
samples <- sort(unique(lane1$SampleID))[grep(pattern = "GC",sort(unique(lane1$SampleID)))]
sort(unique(lane1$SampleID))
samples <- sort(unique(lane1$SampleID))[grep(pattern = "GC1",sort(unique(lane1$SampleID)))]
laneA <- readxl::read_excel("DataSheet.xlsx",sheet = "LaneA")
sort(unique(laneA$SampleID))
sort(unique(laneA$SampleID))[grep(pattern = "PC019",sort(unique(laneA$SampleID)))]
samplesGC1
samplesGC1 <- sort(unique(lane1$SampleID))[grep(pattern = "GC1",sort(unique(lane1$SampleID)))]
samplesGC1
grep("Blank",samplesGC1)
samplesPC019<- sort(unique(laneA$SampleID))[grep(pattern = "PC019",sort(unique(laneA$SampleID)))]
grep("Blank",samplesPC019)
samplesPC019 <- samplesPC019[-grep("Blank",samplesPC019)]
samplesPC019
?grep
gsub("_","-",samplesPC019 )
sort(gsub("_","-",samplesPC019 ))
laneB <- readxl::read_excel("DataSheet.xlsx",sheet = "LaneB")
sort(unique(laneB$SampleID))
samplesPC019.2 <- sort(unique(laneB$SampleID))[grep(pattern = "PC019",sort(unique(laneB$SampleID)))]
samplesPC019.2 <- samplesPC019.2[-grep("Blank",samplesPC019.2)]
samplesPC019.2 <- sort(gsub("_","-",samplesPC019.2))
samplesPC019.2
samplesPC019.2 <- samplesPC019.2[-grep("B6",samplesPC019.2)]
samplesPC019all <- c(samplesPC019,samplesPC019.2)
samplesPC019all <- sort(c(samplesPC019,samplesPC019.2))
samplesPC019all
laneA <- readxl::read_excel("DataSheet.xlsx",sheet = "LaneA")
samplesPC019<- sort(unique(laneA$SampleID))[grep(pattern = "PC019",sort(unique(laneA$SampleID)))]
samplesPC019 <- samplesPC019[-grep("Blank",samplesPC019)]
samplesPC019 <- sort(gsub("_","-",samplesPC019 ))
laneB <- readxl::read_excel("DataSheet.xlsx",sheet = "LaneB")
samplesPC019.2 <- sort(unique(laneB$SampleID))[grep(pattern = "PC019",sort(unique(laneB$SampleID)))]
samplesPC019.2 <- samplesPC019.2[-grep("Blank",samplesPC019.2)]
samplesPC019.2 <- sort(gsub("_","-",samplesPC019.2))
samplesPC019.2 <- samplesPC019.2[-grep("B6",samplesPC019.2)]
samplesPC019all <- sort(c(samplesPC019,samplesPC019.2))
samplesPC019all
unique(samplesPC019all)
samplesPC022 <- sort(unique(laneB$SampleID))[grep(pattern = "PC022",sort(unique(laneB$SampleID)))]
samplesPC022
grep("B[0-9]",samplesPC022)
samplesPC022 <- sort(gsub("_","-",samplesPC022))
samplesPC022
samplesPC022 <- sort(unique(laneB$SampleID))[grep(pattern = "PC022",sort(unique(laneB$SampleID)))]
samplesPC022 <- samplesPC022[-grep("B[0-9]",samplesPC022)]
samplesPC022 <- sort(gsub("_","-",samplesPC022))
samplesPC022
samplesGC1
strsplit(samplesGC1)
strsplit(samplesGC1,"-")
strsplit(samplesGC1,"-")[[2]]
samplesGC1
gsub("IS-","",samplesGC1)
lane1 <- readxl::read_excel("DataSheet.xlsx",sheet = "Lane1")
samplesGC1 <- sort(unique(lane1$SampleID))[grep(pattern = "GC1",sort(unique(lane1$SampleID)))]
samplesGC1 <- gsub("IS-","",samplesGC1)
laneA <- readxl::read_excel("DataSheet.xlsx",sheet = "LaneA")
samplesPC019<- sort(unique(laneA$SampleID))[grep(pattern = "PC019",sort(unique(laneA$SampleID)))]
samplesPC019 <- samplesPC019[-grep("Blank",samplesPC019)]
samplesPC019 <- sort(gsub("_","-",samplesPC019 ))
laneB <- readxl::read_excel("DataSheet.xlsx",sheet = "LaneB")
samplesPC019.2 <- sort(unique(laneB$SampleID))[grep(pattern = "PC019",sort(unique(laneB$SampleID)))]
samplesPC019.2 <- samplesPC019.2[-grep("Blank",samplesPC019.2)]
samplesPC019.2 <- sort(gsub("_","-",samplesPC019.2))
samplesPC019.2 <- samplesPC019.2[-grep("B6",samplesPC019.2)]
samplesPC019all <- sort(c(samplesPC019,samplesPC019.2))
unique(samplesPC019all)
samplesPC022 <- sort(unique(laneB$SampleID))[grep(pattern = "PC022",sort(unique(laneB$SampleID)))]
samplesPC022 <- samplesPC022[-grep("B[0-9]",samplesPC022)]
samplesPC022 <- sort(gsub("_","-",samplesPC022))
allSamples <- strsplit(samplesGC1)
allSamples <- strsplit(samplesGC1,"-")
unlist(strsplit(samplesGC1,"-"))
sapply(strsplit(samplesGC1,"-"), `[`, 1)
sapply(strsplit(samplesGC1,"-"), `[`, 2)
samplesGC1
sapply(strsplit(samplesGC1,"-"), `[`, 2)
sapply(strsplit(samplesGC1,"-"), `[`, 1)
sapply(strsplit(samplesPC019all,"-"), `[`, 1)
sapply(strsplit(samplesPC022,"-"), `[`, 1)
c(sapply(strsplit(samplesGC1,"-"), `[`, 1),
sapply(strsplit(samplesPC019all,"-"), `[`, 1),
sapply(strsplit(samplesPC022,"-"), `[`, 1))
allSamples <- data.frame("ID"=c(samplesGC1,samplesPC019all,samplesPC022)
"Core"=c(sapply(strsplit(samplesGC1,"-"), `[`, 1),sapply(strsplit(samplesPC019all,"-"), `[`, 1),sapply(strsplit(samplesPC022,"-"), `[`, 1)),
allSamples <- data.frame("ID"=c(samplesGC1,samplesPC019all,samplesPC022),
"Core"=c(sapply(strsplit(samplesGC1,"-"), `[`, 1),sapply(strsplit(samplesPC019all,"-"), `[`, 1),sapply(strsplit(samplesPC022,"-"), `[`, 1)),
"Depth"="Core"=c(sapply(strsplit(samplesGC1,"-"), `[`, 2),sapply(strsplit(samplesPC019all,"-"), `[`, 2),sapply(strsplit(samplesPC022,"-"), `[`, 2)))
allSamples <- data.frame("ID"=c(samplesGC1,samplesPC019all,samplesPC022),
"Core"=c(sapply(strsplit(samplesGC1,"-"), `[`, 1),sapply(strsplit(samplesPC019all,"-"), `[`, 1),sapply(strsplit(samplesPC022,"-"), `[`, 1)),
"Depth"=c(sapply(strsplit(samplesGC1,"-"), `[`, 2),sapply(strsplit(samplesPC019all,"-"), `[`, 2),sapply(strsplit(samplesPC022,"-"), `[`, 2)))
View(allSamples)
as.numeric(c(sapply(strsplit(samplesGC1,"-"), `[`, 2),sapply(strsplit(samplesPC019all,"-"), `[`, 2),sapply(strsplit(samplesPC022,"-"), `[`, 2))))
as.numeric(c(sapply(strsplit(samplesGC1,"-"), `[`, 2),sapply(strsplit(samplesPC019all,"-"), `[`, 2),sapply(strsplit(samplesPC022,"-"), `[`, 2)))
allSamples <- data.frame("ID"=c(samplesGC1,samplesPC019all,samplesPC022),
"Core"=c(sapply(strsplit(samplesGC1,"-"), `[`, 1),sapply(strsplit(samplesPC019all,"-"), `[`, 1),sapply(strsplit(samplesPC022,"-"), `[`, 1)),
"Depth"=as.numeric(c(sapply(strsplit(samplesGC1,"-"), `[`, 2),sapply(strsplit(samplesPC019all,"-"), `[`, 2),sapply(strsplit(samplesPC022,"-"), `[`, 2))))
View(allSamples)
write.csv(allSamples,"Age.csv")
metadata<-read.csv("AgeOut.csv")
View(metadata)
EUK.data<- read.csv("rawData/EUK.B05-2006raw.names.csv",row.names = 1)
EUK.tax <- read.csv("taxonomy/EUK.parsed.csv",row.names = 1)
EUK.asvs <- read.fasta("rawdata/ASVs/EUK.DADA2.ASVs.fasta",as.string = TRUE)
??read.fasta
library("seqinr")
EUK.asvs <- read.fasta("rawdata/ASVs/EUK.DADA2.ASVs.fasta",as.string = TRUE)
EUK.asv.len <- nchar(unlist(EUK.asvs))
hist(EUK.asv.len,breaks=100)
colnames(EUK.data)
View(EUK.tax)
rownames(EUK.data)
match(rownames(EUK.data),EUK.tax$OTU)
test <- cbind(EUK.data,EUK.tax[match(rownames(EUK.data),EUK.tax$OTU)])
test <- cbind(EUK.data,EUK.tax[match(rownames(EUK.data),EUK.tax$OTU),])
View(test)
EUK.asvs
test <- cbind(EUK.data,EUK.tax[match(rownames(EUK.data),EUK.tax$OTU),],EUK.asv.len,EUK.asvs )
getSequence(EUK.asvs )
getSequence(EUK.asvs,as.string = T)
test <- cbind(EUK.data,EUK.tax[match(rownames(EUK.data),EUK.tax$OTU),],EUK.asv.len,getSequence(EUK.asvs,as.string = T) )
getSequence(EUK.asvs,as.string = T)
test <- cbind(EUK.data,EUK.tax[match(rownames(EUK.data),EUK.tax$OTU),],EUK.asv.len)
test <- cbind(EUK.data,unlist(EUK.asvs),EUK.tax[match(rownames(EUK.data),EUK.tax$OTU),],EUK.asv.len)
write.csv("test.csv",test)
write.csv(file = "test.csv",test)
library(ggOceanMapsData)
install.packages("ggOceanMapsData")
library(ggOceanMaps)
library(sf)
library(ggspatial)
##
raw.metadata <- read.csv("CoreMetaData.csv")
metadata <- raw.metadata[raw.metadata$CoreID!="GC06",]
basemap(limits = c(-25, -12, 63, 67), bathymetry = TRUE)
limits = c(-25, -12, 63, 67)
#basemap(limits = c(-25, -12, 63, 67), bathy.style = "rcb",rotate = TRUE)+
basemap(limits = c(-25, -12, 63, 67),rotate = TRUE)+
ggspatial::geom_spatial_point(aes(x = Lon, y = Lat),data = metadata, color = "red",crs = 4326)+
ggspatial::geom_spatial_text(aes(x = Lon, y = Lat+0.04,label=CoreID),data = metadata, color = "darkred",cex=2)
xlab("Longitude")+
ylab("Latitude")+
annotation_scale(location = "bl")+
annotation_north_arrow(location = "tr", which_north = "true", height = unit(0.9, "cm"), width = unit(0.9, "cm"))
basemap(limits = c(-25, -12, 63, 67), bathy.style = "rcb",rotate = TRUE)+
ggspatial::geom_spatial_point(aes(x = Lon, y = Lat),data = metadata, color = "red")+
xlab("Longitude")+
ylab("Latitude")
xlab("Longitude")+
ylab("Latitude")+
annotation_scale(location = "bl")+
annotation_north_arrow(location = "tr", which_north = "true", height = unit(0.9, "cm"), width = unit(0.9, "cm"))
#basemap(limits = c(-25, -12, 63, 67), bathy.style = "rcb",rotate = TRUE)+
basemap(limits = c(-25, -12, 63, 67),rotate = TRUE)+
ggspatial::geom_spatial_point(aes(x = Lon, y = Lat),data = metadata, color = "red",crs = 4326)+
ggspatial::geom_spatial_text(aes(x = Lon, y = Lat+0.04,label=CoreID),data = metadata, color = "darkred",cex=2)
basemap(limits = c(-25, -12, 63, 67), bathy.style = "rcb",rotate = TRUE)+
ggspatial::geom_spatial_point(aes(x = Lon, y = Lat),data = metadata, color = "red")+
xlab("Longitude")+
ylab("Latitude")
pdf("Maps/OverviewV1.pdf",height = 6,width = 9)
basemap(limits = c(-25, -12, 63, 67), bathy.style = "rcb",rotate = TRUE)+
#basemap(limits = c(-25, -12, 63, 67),rotate = TRUE)+
ggspatial::geom_spatial_point(aes(x = Lon, y = Lat),data = metadata, color = "red",crs = 4326)+
ggspatial::geom_spatial_text(aes(x = Lon, y = Lat+0.04,label=CoreID),data = metadata, color = "darkred",cex=2)
xlab("Longitude")+
ylab("Latitude")+
annotation_scale(location = "bl")+
annotation_north_arrow(location = "tr", which_north = "true", height = unit(0.9, "cm"), width = unit(0.9, "cm"))
pdf("Maps/OverviewV1.pdf",height = 6,width = 9)
basemap(limits = c(-25, -12, 63, 67), bathy.style = "rcb",rotate = TRUE)+
#basemap(limits = c(-25, -12, 63, 67),rotate = TRUE)+
ggspatial::geom_spatial_point(aes(x = Lon, y = Lat),data = metadata, color = "red",crs = 4326)+
ggspatial::geom_spatial_text(aes(x = Lon, y = Lat+0.04,label=CoreID),data = metadata, color = "darkred",cex=2)+
xlab("Longitude")+
ylab("Latitude")+
annotation_scale(location = "bl")+
annotation_north_arrow(location = "tr", which_north = "true", height = unit(0.9, "cm"), width = unit(0.9, "cm"))
dev.off()
pdf("Maps/OverviewV1.pdf",height = 6,width = 9)
basemap(limits = c(-25, -12, 63, 67), bathy.style = "rcb",rotate = TRUE)+
#basemap(limits = c(-25, -12, 63, 67),rotate = TRUE)+
ggspatial::geom_spatial_point(aes(x = Lon, y = Lat),data = metadata, color = "red",crs = 4326)+
#ggspatial::geom_spatial_text(aes(x = Lon, y = Lat+0.04,label=CoreID),data = metadata, color = "darkred",cex=2)+
xlab("Longitude")+
ylab("Latitude")+
annotation_scale(location = "bl")+
annotation_north_arrow(location = "tr", which_north = "true", height = unit(0.9, "cm"), width = unit(0.9, "cm"))
dev.off()
View(metadata)
