legend(58,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
dev.off()
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA)
par(mfrow=c(1, 1))
legend(55,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
dev.off()
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA)
par(mfrow=c(1, 1))
legend(56,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
dev.off()
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA)
par(mfrow=c(1, 1))
legend(58,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
dev.off()
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
dev.off()
#Both
unique_taxa <- sort(unique(c(rownames(EUK.P19.tax.a), rownames(EUK.GC1.tax.a))))
taxa_colors <- setNames(colorRampPalette(brewer.pal(12, "Paired"))(length(unique_taxa)), unique_taxa)
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
dev.off()
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
dev.off()
EUK.tax.PR2.cat <- read.csv("taxonomy/functionalAnno/EUK.cleaned.PR2.cat.csv",row.names = 1)
#Both
unique_taxa <- sort(unique(c(rownames(EUK.P19.tax.a), rownames(EUK.GC1.tax.a))))
taxa_colors <- setNames(colorRampPalette(brewer.pal(12, "Paired"))(length(unique_taxa)), unique_taxa)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
##PC19
EUK.P19.tax.a <- minAbundance(CountTable(as.character(EUK.tax.PR2$Family),EUK.P19.avr,output = "Abundance"),minAbun=0.01)
EUK.P19.tax.c <- minAbundance(CountTable(as.character(EUK.tax.PR2$Family),EUK.P19.avr,output = "Count"),minAbun=0.01)
row.names(EUK.P19.tax.a)[1] <- "Unknown"
row.names(EUK.P19.tax.c)[1] <- "Unknown"
EUK.P19.tax.a <- as.matrix(prop.table(as.matrix(EUK.P19.tax.a[,order(ages$median[match(colnames(EUK.P19.tax.a),ages$ID2)])]),margin = 2))
EUK.P19.tax.c <- as.matrix(prop.table(as.matrix(EUK.P19.tax.c[,order(ages$median[match(colnames(EUK.P19.tax.c),ages$ID2)])]),margin = 2))
pdf("figures/EUK.P19.tax.Family.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=rev(getPalette(dim(EUK.P19.tax.a)[1])),ylab="Read Abundance",names.arg=ages$median[match(colnames(EUK.P19.tax.a),ages$ID2)])
legend(190,1,rev(rownames(EUK.P19.tax.a)),fill=getPalette(dim(EUK.P19.tax.a)[1]),cex=0.5,bty = "n",y.intersp=0.75)
barplot(EUK.P19.tax.c,las=2,cex.names=0.6,col=rev(getPalette(dim(EUK.P19.tax.c)[1])),ylab="ASV Counts",names.arg=ages$median[match(colnames(EUK.P19.tax.c),ages$ID2)])
legend(190,1,rev(rownames(EUK.P19.tax.c)),fill=getPalette(dim(EUK.P19.tax.c)[1]),cex=0.5,bty = "n",y.intersp=0.75)
dev.off()
##PC19 cat
EUK.P19.tax.a <- minAbundance(CountTable(as.character(EUK.tax.PR2.cat$cat),EUK.P19.avr,output = "Abundance"),minAbun=0.01)
EUK.P19.tax.c <- minAbundance(CountTable(as.character(EUK.tax.PR2.cat$cat),EUK.P19.avr,output = "Count"),minAbun=0.01)
EUK.P19.tax.a <- as.matrix(prop.table(as.matrix(EUK.P19.tax.a[,order(ages$median[match(colnames(EUK.P19.tax.a),ages$ID2)])]),margin = 2))
EUK.P19.tax.c <- as.matrix(prop.table(as.matrix(EUK.P19.tax.c[,order(ages$median[match(colnames(EUK.P19.tax.c),ages$ID2)])]),margin = 2))
pdf("figures/EUK.P19.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=rev(getPalette(dim(EUK.P19.tax.a)[1])),ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)])
legend(190,1,rev(rownames(EUK.P19.tax.a)),fill=getPalette(dim(EUK.P19.tax.a)[1]),cex=0.5,bty = "n",y.intersp=0.75)
barplot(EUK.P19.tax.c,las=2,cex.names=0.6,col=rev(getPalette(dim(EUK.P19.tax.c)[1])),ylab="ASV Counts",names.arg=1950-ages$median[match(colnames(EUK.P19.tax.c),ages$ID2)])
legend(190,1,rev(rownames(EUK.P19.tax.c)),fill=getPalette(dim(EUK.P19.tax.c)[1]),cex=0.5,bty = "n",y.intersp=0.75)
dev.off()
#Both
unique_taxa <- sort(unique(c(rownames(EUK.P19.tax.a), rownames(EUK.GC1.tax.a))))
taxa_colors <- setNames(colorRampPalette(brewer.pal(12, "Paired"))(length(unique_taxa)), unique_taxa)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
##PC19 cat
EUK.P19.tax.a <- minAbundance(CountTable(as.character(EUK.tax.PR2.cat$cat),EUK.P19.avr,output = "Abundance"),minAbun=0.01)
EUK.P19.tax.c <- minAbundance(CountTable(as.character(EUK.tax.PR2.cat$cat),EUK.P19.avr,output = "Count"),minAbun=0.01)
EUK.P19.tax.a <- as.matrix(prop.table(as.matrix(EUK.P19.tax.a[,order(ages$median[match(colnames(EUK.P19.tax.a),ages$ID2)])]),margin = 2))
EUK.P19.tax.c <- as.matrix(prop.table(as.matrix(EUK.P19.tax.c[,order(ages$median[match(colnames(EUK.P19.tax.c),ages$ID2)])]),margin = 2))
#Both
unique_taxa <- sort(unique(c(rownames(EUK.P19.tax.a), rownames(EUK.GC1.tax.a))))
taxa_colors <- setNames(colorRampPalette(brewer.pal(12, "Paired"))(length(unique_taxa)), unique_taxa)
unique_taxa
EUK.tax.PR2 <- read.csv("taxonomy/EUK.cleaned.PR2.csv",row.names = 1)
EUK.tax.PR2.cat <- read.csv("taxonomy/functionalAnno/EUK.cleaned.PR2.cat.csv",row.names = 1)
climate <- read.csv("metadata/climate.csv",row.names = 1)
#GC1 cat
EUK.GC1.tax.a <- minAbundance(CountTable(as.character(EUK.tax.PR2.cat$cat),EUK.GC1.avr,output = "Abundance"),minAbun=0.01)
EUK.GC1.tax.c <- minAbundance(CountTable(as.character(EUK.tax.PR2.cat$cat),EUK.GC1.avr,output = "Count"),minAbun=0.01)
EUK.GC1.tax.a <- as.matrix(prop.table(as.matrix(EUK.GC1.tax.a[,order(ages$median[match(colnames(EUK.GC1.tax.a),ages$ID2)])]),margin = 2))
EUK.GC1.tax.c <- as.matrix(prop.table(as.matrix(EUK.GC1.tax.c[,order(ages$median[match(colnames(EUK.GC1.tax.c),ages$ID2)])]),margin = 2))
barplot(EUK.GC1.tax.a,col=rev(getPalette(dim(EUK.GC1.tax.a)[1])))
barplot(EUK.GC1.tax.c,col=rev(getPalette(dim(EUK.GC1.tax.c)[1])))
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=rev(getPalette(dim(EUK.GC1.tax.a)[1])),ylab="Read Abundance",names.arg=ages$median[match(colnames(EUK.GC1.tax.a),ages$ID2)])
legend(56,1,rev(rownames(EUK.GC1.tax.a)),fill=getPalette(dim(EUK.GC1.tax.a)[1]),cex=0.5,bty = "n",y.intersp=0.75)
barplot(EUK.GC1.tax.c,las=2,cex.names=0.6,col=rev(getPalette(dim(EUK.GC1.tax.c)[1])),ylab="ASV Counts",names.arg=ages$median[match(colnames(EUK.GC1.tax.c),ages$ID2)])
legend(56,1,rev(rownames(EUK.GC1.tax.c)),fill=getPalette(dim(EUK.GC1.tax.c)[1]),cex=0.5,bty = "n",y.intersp=0.75)
##PC19
EUK.P19.tax.a <- minAbundance(CountTable(as.character(EUK.tax.PR2$Family),EUK.P19.avr,output = "Abundance"),minAbun=0.01)
EUK.P19.tax.c <- minAbundance(CountTable(as.character(EUK.tax.PR2$Family),EUK.P19.avr,output = "Count"),minAbun=0.01)
row.names(EUK.P19.tax.a)[1] <- "Unknown"
row.names(EUK.P19.tax.c)[1] <- "Unknown"
EUK.P19.tax.a <- as.matrix(prop.table(as.matrix(EUK.P19.tax.a[,order(ages$median[match(colnames(EUK.P19.tax.a),ages$ID2)])]),margin = 2))
EUK.P19.tax.c <- as.matrix(prop.table(as.matrix(EUK.P19.tax.c[,order(ages$median[match(colnames(EUK.P19.tax.c),ages$ID2)])]),margin = 2))
##PC19 cat
EUK.P19.tax.a <- minAbundance(CountTable(as.character(EUK.tax.PR2.cat$cat),EUK.P19.avr,output = "Abundance"),minAbun=0.01)
EUK.P19.tax.c <- minAbundance(CountTable(as.character(EUK.tax.PR2.cat$cat),EUK.P19.avr,output = "Count"),minAbun=0.01)
EUK.P19.tax.a <- as.matrix(prop.table(as.matrix(EUK.P19.tax.a[,order(ages$median[match(colnames(EUK.P19.tax.a),ages$ID2)])]),margin = 2))
EUK.P19.tax.c <- as.matrix(prop.table(as.matrix(EUK.P19.tax.c[,order(ages$median[match(colnames(EUK.P19.tax.c),ages$ID2)])]),margin = 2))
pdf("figures/EUK.P19.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=rev(getPalette(dim(EUK.P19.tax.a)[1])),ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)])
legend(190,1,rev(rownames(EUK.P19.tax.a)),fill=getPalette(dim(EUK.P19.tax.a)[1]),cex=0.5,bty = "n",y.intersp=0.75)
barplot(EUK.P19.tax.c,las=2,cex.names=0.6,col=rev(getPalette(dim(EUK.P19.tax.c)[1])),ylab="ASV Counts",names.arg=1950-ages$median[match(colnames(EUK.P19.tax.c),ages$ID2)])
legend(190,1,rev(rownames(EUK.P19.tax.c)),fill=getPalette(dim(EUK.P19.tax.c)[1]),cex=0.5,bty = "n",y.intersp=0.75)
dev.off()
#Both
unique_taxa <- sort(unique(c(rownames(EUK.P19.tax.a), rownames(EUK.GC1.tax.a))))
taxa_colors <- setNames(colorRampPalette(brewer.pal(12, "Paired"))(length(unique_taxa)), unique_taxa)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=(1,0))
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0))
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),xaxt=FALSE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),xaxt=F)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),xaxt="n")
seq(0,1,.2)
axis(1,at=seq(0,1,.2),labels=rev(seq(0,1,.2)))
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)))
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
dev.off()
palette <- colorRampPalette(brewer.pal(11, "Spectral"))(24)
# Visualize the palette
image(1:24, 1, as.matrix(1:24), col=palette, xlab="Index", ylab="", xaxt='n', yaxt='n', bty='n')
#Both
unique_taxa <- sort(unique(c(rownames(EUK.P19.tax.a), rownames(EUK.GC1.tax.a))))
taxa_colors <- setNames(colorRampPalette(brewer.pal(12, "Set1"))(length(unique_taxa)), unique_taxa)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
#Both
unique_taxa <- sort(unique(c(rownames(EUK.P19.tax.a), rownames(EUK.GC1.tax.a))))
taxa_colors <- setNames(colorRampPalette(brewer.pal(12, "Set2"))(length(unique_taxa)), unique_taxa)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
#Both
unique_taxa <- sort(unique(c(rownames(EUK.P19.tax.a), rownames(EUK.GC1.tax.a))))
taxa_colors <- setNames(colorRampPalette(brewer.pal(12, "Set3"))(length(unique_taxa)), unique_taxa)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
#Both
unique_taxa <- sort(unique(c(rownames(EUK.P19.tax.a), rownames(EUK.GC1.tax.a))))
taxa_colors <- setNames(colorRampPalette(brewer.pal(12, "Set1"))(length(unique_taxa)), unique_taxa)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
EUK.P19.tax.a
View(EUK.P19.tax.a)
#Both
unique_taxa <- sort(unique(c(rownames(EUK.P19.tax.a), rownames(EUK.GC1.tax.a))))
unique_taxa
unique_taxa
order(rownames(EUK.P19.tax.a))
EUK.P19.tax.a[,order(rownames(EUK.P19.tax.a))]
EUK.P19.tax.a[order(rownames(EUK.P19.tax.a)),]
EUK.P19.tax.a <- EUK.P19.tax.a[order(rownames(EUK.P19.tax.a)),]
EUK.GC1.tax.a <- EUK.GC1.tax.a[order(rownames(EUK.GC1.tax.a)),]
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
dev.off()
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,pt.cex = 2,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
dev.off()
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,pt.cex = 5,bty = "n", xpd = TRUE,inset = c(-0.25, 0))
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,pt.cex = 2,bty = "n", xpd = TRUE)
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,pt.cex = 3,bty = "n", xpd = TRUE)
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,pt.cex = 4,bty = "n", xpd = TRUE)
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.6,pt.cex = 4,bty = "n", xpd = TRUE)
dev.off()
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.7,pt.cex = 4,bty = "n", xpd = TRUE)
dev.off()
legend(57,0.6,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.7,pch=15,pt.cex = 4,bty = "n", xpd = TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,col=taxa_colors[unique_taxa],cex=0.7,pch=15,pt.cex = 2,bty = "n", xpd = TRUE)
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,0.6,unique_taxa,col=taxa_colors[unique_taxa],cex=0.7,pch=15,pt.cex = 2,bty = "n", xpd = TRUE)
dev.off()
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,0.8,unique_taxa,col=taxa_colors[unique_taxa],cex=0.7,pch=15,pt.cex = 2,bty = "n", xpd = TRUE)
dev.off()
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,1.1,unique_taxa,col=taxa_colors[unique_taxa],cex=0.7,pch=15,pt.cex = 2,bty = "n", xpd = TRUE)
dev.off()
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,-0.5,unique_taxa,col=taxa_colors[unique_taxa],cex=0.7,pch=15,pt.cex = 2,bty = "n", xpd = TRUE)
dev.off()
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,-0.2,unique_taxa,col=taxa_colors[unique_taxa],cex=0.7,pch=15,pt.cex = 2,bty = "n", xpd = TRUE)
dev.off()
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,-0.8,unique_taxa,col=taxa_colors[unique_taxa],cex=0.7,pch=15,pt.cex = 2,bty = "n", xpd = TRUE)
dev.off()
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,-0.5,unique_taxa,col=taxa_colors[unique_taxa],cex=0.7,pch=15,pt.cex = 2,bty = "n", xpd = TRUE)
dev.off()
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,-0.1,unique_taxa,col=taxa_colors[unique_taxa],cex=0.7,pch=15,pt.cex = 2,bty = "n", xpd = TRUE)
dev.off()
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,1,unique_taxa,col=taxa_colors[unique_taxa],cex=0.7,pch=15,pt.cex = 2,bty = "n", xpd = TRUE)
dev.off()
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,0.2,unique_taxa,col=taxa_colors[unique_taxa],cex=0.7,pch=15,pt.cex = 2,bty = "n", xpd = TRUE)
dev.off()
pdf("figures/EUK.tax.cat.pdf",width = 12,height = 9)
par(mfrow=c(2,1),mar=c(5.1, 4.1, 1.1, 6.1),xpd=TRUE)
barplot(EUK.P19.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.P19.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.P19.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
#legend(190,0.2,unique_taxa,fill=taxa_colors[unique_taxa],cex=0.5,bty = "n",y.intersp=0.75, xpd = TRUE,inset = c(-0.25, 0))
barplot(EUK.GC1.tax.a,las=2,cex.names=0.6,col=taxa_colors[rownames(EUK.GC1.tax.a)],ylab="Read Abundance",names.arg=1950-ages$mean[match(colnames(EUK.GC1.tax.a),ages$ID2)],border = NA,ylim=c(1,0),yaxt="n")
axis(2,at=seq(0,1,.2),labels=rev(seq(0,1,.2)),las=2)
par(mfrow=c(1, 1))
legend(57,0.3,unique_taxa,col=taxa_colors[unique_taxa],cex=0.7,pch=15,pt.cex = 2,bty = "n", xpd = TRUE)
dev.off()
library(ggOceanMapsData)
library(ggOceanMaps)
library(sf)
library(ggspatial)
##
raw.metadata <- read.csv("metadata/CoreMetaData.csv")
metadata <- raw.metadata[raw.metadata$CoreID!="GC06"&raw.metadata$CoreID!="PC022",]
basemap(limits = c(-25, -12, 63, 67), bathymetry = TRUE)
limits = c(-25, -12, 63, 67)
pdf("Maps/OverviewV1.pdf",height = 6,width = 9)
basemap(limits = c(-25, -12, 63, 67), bathy.style = "rcb",rotate = TRUE)+
#basemap(limits = c(-25, -12, 63, 67),rotate = TRUE)+
ggspatial::geom_spatial_point(aes(x = Lon, y = Lat),data = metadata, color = c("black"),crs = 4326,cex=2.5)+
ggspatial::geom_spatial_point(aes(x = Lon, y = Lat),data = metadata, color = c("dodgerblue","darkred"),crs = 4326,cex=2)+
ggspatial::geom_spatial_text(aes(x = Lon, y = Lat+0.1,label=CoreID),data = metadata,cex=2)+
xlab("Longitude")+
ylab("Latitude")+
annotation_scale(location = "bl")+
annotation_north_arrow(location = "tr", which_north = "true", height = unit(0.9, "cm"), width = unit(0.9, "cm"))
##
raw.metadata <- read.csv("metadata/CoreMetaData.csv")
metadata <- raw.metadata[raw.metadata$CoreID!="GC06"&raw.metadata$CoreID!="PC022",]
basemap(limits = c(-25, -12, 63, 67), bathymetry = TRUE)
limits = c(-25, -12, 63, 67)
pdf("Maps/OverviewV1.pdf",height = 6,width = 9)
basemap(limits = c(-25, -12, 63, 67), bathy.style = "rcb",rotate = TRUE)+
#basemap(limits = c(-25, -12, 63, 67),rotate = TRUE)+
ggspatial::geom_spatial_point(aes(x = Lon, y = Lat),data = metadata, color = c("black"),crs = 4326,cex=2.5)+
ggspatial::geom_spatial_point(aes(x = Lon, y = Lat),data = metadata, color = c("dodgerblue","darkred"),crs = 4326,cex=2)+
ggspatial::geom_spatial_text(aes(x = Lon, y = Lat+0.1,label=CoreID),data = metadata,cex=2)+
xlab("Longitude")+
ylab("Latitude")+
annotation_scale(location = "bl")+
annotation_north_arrow(location = "tr", which_north = "true", height = unit(0.9, "cm"), width = unit(0.9, "cm"))
dev.off()
pdf("Maps/OverviewV1mini.pdf",height = 3.5,width = 4.2)
basemap(limits = c(-25, -13, 63, 67), bathy.style = "rcb",rotate = TRUE)+
ggspatial::geom_spatial_point(aes(x = Lon, y = Lat),data = metadata, color = c("black"),crs = 4326,cex=4.5)+
ggspatial::geom_spatial_point(aes(x = Lon, y = Lat),data = metadata, color = c("#52868B","#282E69"),crs = 4326,cex=4)+
ggspatial::geom_spatial_text(aes(x = Lon, y = Lat+0.3,label=c("GC01","PC19")),data = metadata,cex=3)+
xlab("")+
ylab("")+
theme(legend.position="right",legend.box.spacing=unit(0.5, "lines"),
legend.key.size = unit(0.3, 'cm'), #change legend key size
legend.key.height = unit(0.5, 'cm'), #change legend key height
legend.key.width = unit(0.3, 'cm'), #change legend key width
legend.title = element_text(size=8), #change legend title font size
legend.text = element_text(size=6))+
#theme(legend.position.inside = c(1,1))+
annotation_scale(location = "bl")+
annotation_north_arrow(location = "tl", which_north = "true", height = unit(0.9, "cm"), width = unit(0.9, "cm"))
dev.off()
library("mgcv")
library("dplR")
library("zoo")
# some functions
add.alpha <- function(col, alpha=1){
if(missing(col))
stop("Please provide a vector of colours.")
apply(sapply(col, col2rgb)/255, 2,
function(x)
rgb(x[1], x[2], x[3], alpha=alpha))
}
### lets input data
climate <- read.csv("rawdata/climate/combined.csv")
sampledates <- read.csv("metadata/AgeOut.csv")
climatedat <- data.frame("Sample"=sampledates$ID,"Core"=sampledates$Core,"Date_bp_mean"=sampledates$mean,"Date_CE_mean"=1950-sampledates$mean)
unique(climate$record)
pop <- read.csv("rawdata/human/settlement.csv")
pdf("figures/composite/HumanPOP.pdf",height=2.8,width=10)
par(mar=c(4.1,4.1,2.1,6.1))
plot(pop$Date,pop$Population,
ylim=c(0,310000),
xlim=c(-1550,2000),
bty = 'n',xaxt='n',yaxt="n",ylab="",xlab="",
type="l",lwd=3,col="orange")
mtext("Iceland Human Population", side = 4, line = 4,col="orange")
axis(4,at=c(0,50000,100000,150000,200000,250000,300000),las=2,cex.axis=0.8)
axis(1,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
dev.off()
pop <- read.csv("rawdata/human/settlement.csv")
pdf("figures/Fig1//HumanPOP.pdf",height=2.8,width=10)
par(mar=c(4.1,4.1,2.1,6.1))
plot(pop$Date,pop$Population,
ylim=c(0,310000),
xlim=c(-1550,2000),
bty = 'n',xaxt='n',yaxt="n",ylab="",xlab="",
type="l",lwd=3,col="orange")
mtext("Iceland Human Population", side = 4, line = 4,col="orange")
axis(4,at=c(0,50000,100000,150000,200000,250000,300000),las=2,cex.axis=0.8)
axis(1,at=seq(-1500,2000,500),labels=paste0(sqrt(seq(-1500,2000,500)^2),c("BCE","BCE","BCE","","CE","CE","CE","CE")),lwd.ticks = 2,cex=2)
dev.off()
